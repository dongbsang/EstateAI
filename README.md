# PropLens 🏠

> AI 기반 부동산 매물 **자동** 검색 및 분석 시스템  
> Rule-based + LLM Hybrid Real Estate Analyzer

## 프로젝트 개요

공인중개사 방문 전, 매물을 **자동으로** 수집하고 분석하는 도구입니다.

### 핵심 기능

| 기능 | 설명 | 데이터 소스 |
|------|------|-------------|
| 🔍 **자동 매물 수집** | 조건에 맞는 매물 자동 크롤링 | 네이버 부동산 |
| 💰 **실거래가 검증** | 시세 대비 가격 분석 + 전세가율 | 국토부 API |
| ⚡ **조건 필터링** | 예산/면적/세대수 등 규칙 기반 | 코드 |
| ⚠️ **리스크 분석** | 위험 신호 패턴 매칭 | 코드 + 텍스트 |
| ❓ **질문 생성** | 중개사 질문 자동 생성 | 규칙 기반 |
| 📊 **리포트 출력** | 추천 순위 및 상세 분석 | 종합 |

## 핵심 원칙

1. **LLM은 보조 엔진** - 판단/필터/점수는 규칙 기반 코드로
2. **llama.cpp (GGUF) 내장형 배포** - 외부 유료 API 의존 금지
3. **자동화 우선** - 수동 입력 최소화
4. **설명 가능한 결과** - 왜 탈락/추천인지 근거 필수

## 빠른 시작

### 1. 설치

```bash
# 클론
git clone https://github.com/your-repo/PropLens.git
cd PropLens

# 가상환경
python -m venv .venv_e
.venv_e\Scripts\activate  # Windows
source .venv_e/bin/activate  # Linux/Mac

# 의존성 설치
pip install -r requirements.txt

# 환경변수 설정
cp .env.example .env
```

### 2. 환경변수 설정 (.env)

```ini
# 필수 아님 - 없어도 기본 기능 동작
DATA_GO_KR_API_KEY=your_api_key  # 국토부 실거래가 (전세가율 분석)
ODSAY_API_KEY=your_api_key       # 출퇴근 시간 계산
```

### 3. 실행

```bash
# Streamlit UI 실행
streamlit run ui/app.py

# 브라우저에서 http://localhost:8501 접속
```

## 사용 방법

### UI 사용

1. **사이드바에서 조건 설정**
   - 거래 유형: 전세/월세/매매
   - 예산: 최대 보증금
   - 지역: 서울시 구 단위 선택
   - 면적: 최소 전용면적
   - 세대수: 최소 세대수

2. **"검색 시작" 클릭**
   - 캐시가 없으면 1-2분 소요
   - 동일 조건은 24시간 캐시

3. **결과 확인**
   - 추천 매물: 점수순 정렬
   - 상세 정보: 전세가율, 리스크, 질문 목록

## 파이프라인 구조

```
UserInput (검색 조건)
    │
    ▼
┌─────────────────────────────────────────────────────────────┐
│ Phase 1: 수집 & 보강                                         │
│ SearchAgent → EnrichAgent → NormalizeAgent                  │
│ (네이버 부동산)  (국토부 실거래가)                              │
└─────────────────────────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────────────────────────┐
│ Phase 2: 필터링                                              │
│ FilterAgent (규칙 기반 - 예산/면적/세대수)                     │
└─────────────────────────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────────────────────────┐
│ Phase 3: 통근 시간 (선택)                                    │
│ CommuteAgent (ODsay API - 필터 통과 매물만)                  │
└─────────────────────────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────────────────────────┐
│ Phase 4: 분석 & 리포트                                       │
│ ScoreAgent → RiskAgent → QuestionAgent → ReportAgent        │
│ (점수화)      (리스크)    (질문생성)      (리포트)             │
└─────────────────────────────────────────────────────────────┘
    │
    ▼
Report (최종 결과)
```

## 폴더 구조

```
PropLens/
├── app/
│   ├── agents/           # Agent 구현
│   ├── data_sources/     # 외부 API 클라이언트
│   ├── domain/           # 규칙 기반 로직
│   ├── pipeline/         # 오케스트레이션
│   ├── schemas/          # Pydantic 모델
│   └── llm/              # LLM 래퍼 (향후)
├── ui/                   # Streamlit UI
├── models/               # GGUF 모델 (향후)
├── data/                 # 샘플/캐시 데이터
├── tests/                # 테스트
└── docs/                 # 문서
```

## API 키 발급 (선택)

### 국토부 실거래가 API
- [공공데이터포털](https://www.data.go.kr) 회원가입
- "국토교통부_아파트 전월세 실거래가" API 신청
- 승인 후 API 키 발급

### ODsay 대중교통 API
- [ODsay Lab](https://lab.odsay.com) 회원가입
- API 키 발급 (무료 1,000건/일)

## 주의사항

⚠️ **네이버 부동산 API 관련**
- 과도한 요청 시 차단될 수 있음 (자동 2-3초 딜레이 적용)
- 차단 시 30분 후 재시도 필요
- 24시간 캐시로 중복 요청 방지

⚠️ **상업적 용도**
- 크롤링 관련 법적 검토 필요

## 라이선스

MIT License

## 상세 문서

기술적 세부사항은 [README_DETAIL.md](./README_DETAIL.md) 참조
